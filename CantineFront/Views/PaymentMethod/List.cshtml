<div class="container-fluid p-4">
    <div class="card shadow-sm border-0 mb-4">
        <div class="card-body">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h2 class="h4 mb-0 text-primary">
                        <i class="fas fa-building me-2"></i>Gestion des Methodes de paiement
                    </h2>
                    <p class="text-muted mb-0">Gérez les methodes de paiement de votre entreprise</p>
                </div>
                <div class="col-md-6 text-end">
                    <a class="btn btn-primary btn-lg px-4" href="/PaymentMethod/Create">
                        <i class="fas fa-plus-circle me-2"></i>Nouveau methode de paiement
                    </a>
                </div>
            </div>
        </div>
    </div>

<!-- DataTable Card -->
<div class="card shadow-sm border-0">
    <div class="card-body p-0">
        <div class="table-responsive">
                <table class="table table-hover mb-0" id="tbPaymentMethods" style="width:100%">
                <thead> 
                    <tr>
                        <th>#</th>
                        <th>Nom</th>
                        <th>Code</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                </thead>

                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>

<!-- Loading Spinner -->
<div id="loadingSpinner" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Chargement...</span>
    </div>
    <p class="text-muted mt-2">Chargement des methodes de paiement...</p>
</div>

@section Styles {
    <link rel="stylesheet" href="~/css/categorie.css" />
}

@section Scripts{
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="text/javascript">
        $(function () {
         //   $("#tbPaymentMethods").DataTable();
            var successHandler = function (res) {
                console.log(JSON.stringify(res))
                if (res) {

                    if (res.success) {
                        ToastR(res.message, res.status, 15);
                       
                     $('#tbPaymentMethods').DataTable({
                            data: res.data,
                            responsive: true,
                            destroy: true,
                            language: {
                                "zeroRecords": "<div class='dataTables_empty'><i class='fas fa-inbox'></i><br>Aucun PaymentMethod trouvé</div>",
                                "emptyTable": "<div class='dataTables_empty'><i class='fas fa-inbox'></i><br>Aucune donnée disponible</div>",
                                "info": "Affichage de _START_ à _END_ sur _TOTAL_ PaymentMethods",
                                "infoEmpty": "Affichage de 0 à 0 sur 0 PaymentMethods",
                                "infoFiltered": "(filtrées depuis _MAX_ PaymentMethods au total)",
                                "lengthMenu": "Afficher _MENU_ PaymentMethods",
                                "search": "<i class='fas fa-search'></i>",
                                "paginate": {
                                    "first": "<i class='fas fa-angle-double-left'></i>",
                                    "last": "<i class='fas fa-angle-double-right'></i>",
                                    "next": "<i class='fas fa-angle-right'></i>",
                                    "previous": "<i class='fas fa-angle-left'></i>"
                                }
                            },

                            columns: [
                                {
                                    width: '5%',
                                    data: null,
                                    render: function (data, type, row, meta) {
                                        return '<span class="text-muted">' + (meta.row + 1) + '</span>';
                                    }
                                },
                                {
                                    width: '20%',
                                    data: 'name',
                                    defaultContent: '',
                                },
                                 {
                                    width: '20%',
                                    data: 'code',
                                    defaultContent: '',
                                },
                                
                                {

                                    data: "actif",
                                    width: '7%',
                                    defaultContent: "",
                                    render: function (data, type, row) {

                                        var className = (data == true ? "badge-success" : "badge-danger");
                                        var status = (data == true ? "actif" : "inactif");

                                        return `<span class="badge badge-pill ${className}">${status}</span>`;
                                    }
                                },
                                 {
                                    data: null,
                                    width: '20%',
                                    className: 'text-center',
                                    render: function (data, type, row) {
                                        var btnEdit = '<a class="btn btn-action btn-edit me-2" href="/PaymentMethod/Update/' + row.id + '" title="Modifier">' +
                                                     '<i class="fas fa-edit me-1"></i>Modifier</a>';

                                        var btnDelete = '<button type="button" class="btn btn-action btn-delete" ' +
                                                       'data-method="DELETE" ' +
                                                       'data-message="Voulez-vous vraiment supprimer cet PaymentMethod <b>' + row.name + '</b> ?" ' +
                                                       'data-url="/PaymentMethod/DeletePaymentMethod/' + row.id + '" ' +
                                                       'data-bs-toggle="modal" data-bs-target="#confirmModal" ' +
                                                       'title="Supprimer">' +
                                                       '<i class="fas fa-trash me-1"></i>Supprimer</button>';

                                        return '<div class="d-flex justify-content-center">' + btnEdit + btnDelete + '</div>';
                                    }
                                },
                            ]
                            
                        });


                    } else {
                      
                        ToastR(res.message, res.status, 15);
                    }
                }
            }

            var errorHandler = (err) => {
              
                ToastR("Une erreur a été rencontré", "error", 15);
            }


            ajaxManager('GET', '/PaymentMethod/GetPaymentMethods', successHandler, errorHandler);




        });

    </script>
            }